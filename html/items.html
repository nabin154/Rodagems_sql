<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jewelry Catalog - Roda Gems</title>
<link rel="stylesheet" href="../css/items.css">
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo">Roda Gems</div>
            <nav>
                <ul id="nav-menu">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="items.html">Collections</a></li>
                    <li><a href="about.html">About</a></li>
                    <li><a href="contact.html">Contact</a></li>
                    <li><a href="login.html">Login</a></li>
                </ul>
            </nav>
            <div class="mobile-menu" id="mobile-toggle">☰</div>
        </div>
    </header>

    <main>
        <div class="container">
            <h1 class="page-title">Jewelry Collection</h1>
            <p class="page-subtitle">Discover our exquisite collection of handcrafted jewelry, each piece telling its own story of elegance and luxury.</p>

            <div class="controls">
                <div class="filters">
                    <div class="filter-group">
                        <label class="filter-label">Material</label>
                        <select id="materialFilter">
                            <option value="">All Materials</option>
                            <option value="Gold">Gold</option>
                            <option value="Silver">Silver</option>
                            <option value="Platinum">Platinum</option>
                            <option value="Rose Gold">Rose Gold</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">Category</label>
                        <select id="categoryFilter">
                            <option value="">All Categories</option>
                            <option value="Ring">Rings</option>
                            <option value="Necklace">Necklaces</option>
                            <option value="Earrings">Earrings</option>
                            <option value="Bracelet">Bracelets</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">Sort by Price</label>
                        <select id="priceSort">
                            <option value="">Default</option>
                            <option value="asc">Low to High</option>
                            <option value="desc">High to Low</option>
                        </select>
                    </div>
                </div>

                <div class="search-box">
                    <label class="filter-label">Search</label>
                    <input type="text" id="searchInput" class="search-input" placeholder="Search jewelry...">
                </div>

                <button class="clear-filters" onclick="clearFilters()">Clear All</button>
            </div>

            <div class="results-count" id="resultsCount"></div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                Loading jewelry collection...
            </div>

            <div class="products-grid" id="productsGrid"></div>

            <div class="no-results" id="noResults" style="display: none;">
                <div class="no-results-icon">💎</div>
                <h3>No jewelry found</h3>
                <p>Try adjusting your filters or search terms to find the perfect piece.</p>
            </div>
        </div>
    </main>
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>Quick Links</h3>
                <a href="home.html">Home</a>
                <a href="#collections">Collections</a>
                <a href="about.html">About Us</a>
                <a href="#services">Services</a>
            </div>
            <div class="footer-section">
                <h3>Services</h3>
                <a href="#">Custom Design</a>
                <a href="#">Jewelry Repair</a>
                <a href="#">Appraisals</a>
                <a href="#">Cleaning & Maintenance</a>
            </div>
            <div class="footer-section">
                <h3>Contact Info</h3>
                <a href="tel:+1234567890">+1 (234) 567-8900</a>
                <a href="mailto:info@rodagems.com">info@rodagems.com</a>
                <a href="#">123 Luxury Lane, Sydney</a>
                <a href="#">Mon-Sat: 10AM-7PM</a>
            </div>
            <div class="footer-section">
                <h3>Follow Us</h3>
                <a href="#">Facebook</a>
                <a href="#">Instagram</a>
                <a href="#">Twitter</a>
                <a href="#">Pinterest</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 Roda Gems. All rights reserved. | Privacy Policy | Terms of Service</p>
        </div>
    </footer>
    <script>
    
      let jewelryDatabase = [];
    let filteredProducts = [];

    const productsGrid = document.getElementById('productsGrid');
    const loading = document.getElementById('loading');
    const noResults = document.getElementById('noResults');
    const resultsCount = document.getElementById('resultsCount');
    const materialFilter = document.getElementById('materialFilter');
    const categoryFilter = document.getElementById('categoryFilter');
    const priceSort = document.getElementById('priceSort');
    const searchInput = document.getElementById('searchInput');

    async function fetchJewelryData() {
        loading.style.display = 'block';
        productsGrid.style.display = 'none';
        noResults.style.display = 'none';

        try {
            const res = await fetch('http://localhost:3000/api/jewelry');
            const data = await res.json();
            jewelryDatabase = data;
            filteredProducts = [...jewelryDatabase];
            renderProducts();
        } catch (err) {
            console.error("Failed to fetch data:", err);
            noResults.style.display = 'block';
            resultsCount.textContent = 'Could not load products. Try again later.';
        } finally {
            loading.style.display = 'none';
        }
    }

    function renderProducts() {
        if (filteredProducts.length === 0) {
            productsGrid.style.display = 'none';
            noResults.style.display = 'block';
            resultsCount.textContent = '';
            return;
        }

        noResults.style.display = 'none';
        productsGrid.style.display = 'grid';
        resultsCount.textContent = `Showing ${filteredProducts.length} jewelry piece${filteredProducts.length !== 1 ? 's' : ''}`;

        productsGrid.innerHTML = filteredProducts.map(product => `
            <div class="product-card">
                <div class="product-image">
                    ${product.image ? `<img src="${product.image}" alt="${product.name}">` : `<div class="product-image-placeholder">${getProductIcon(product.category)}</div>`}
                    ${product.badge ? `<div class="product-badge">${product.badge}</div>` : ''}
                </div>
                <div class="product-info">
                    <h3 class="product-name">${product.name}</h3>
                    <div class="product-material">${product.material} • ${product.category}</div>
                    <p class="product-description">${product.description}</p>
                    <div class="product-price">$${product.price.toLocaleString()}</div>
                    <button class="order-btn" onclick=" if (confirm('Are you sure you want to order this product?'))orderNow(${product.id})">Order Now</button>
                </div>
            </div>
        `).join('');
    }

    function getProductIcon(category) {
        const icons = {
            'Ring': '💍',
            'Necklace': '📿',
            'Earrings': '👂',
            'Bracelet': '📿'
        };
        return icons[category] || '💎';
    }

    function applyFilters() {
        let filtered = [...jewelryDatabase];

        const materialValue = materialFilter.value;
        if (materialValue) {
            filtered = filtered.filter(product => product.material === materialValue);
        }

        const categoryValue = categoryFilter.value;
        if (categoryValue) {
            filtered = filtered.filter(product => product.category === categoryValue);
        }

        const searchValue = searchInput.value.toLowerCase();
        if (searchValue) {
            filtered = filtered.filter(product => 
                product.name.toLowerCase().includes(searchValue) ||
                product.description.toLowerCase().includes(searchValue) ||
                product.material.toLowerCase().includes(searchValue)
            );
        }

        const sortValue = priceSort.value;
        if (sortValue === 'asc') {
            filtered.sort((a, b) => a.price - b.price);
        } else if (sortValue === 'desc') {
            filtered.sort((a, b) => b.price - a.price);
        }

        filteredProducts = filtered;
        renderProducts();
    }

    function clearFilters() {
        materialFilter.value = '';
        categoryFilter.value = '';
        priceSort.value = '';
        searchInput.value = '';
        filteredProducts = [...jewelryDatabase];
        renderProducts();
    }

    function orderNow(productId) {
        const product = jewelryDatabase.find(p => p.id === productId);
        alert(`Thank you for your interest in ${product.name}!\n\nPrice: $${product.price.toLocaleString()}\n\nPlease contact us at +1 (234) 567-8900 to complete your order.`);
    }

    materialFilter.addEventListener('change', applyFilters);
    categoryFilter.addEventListener('change', applyFilters);
    priceSort.addEventListener('change', applyFilters);
    searchInput.addEventListener('input', applyFilters);

    const mobileToggle = document.getElementById('mobile-toggle');
    const navMenu = document.getElementById('nav-menu');

    mobileToggle.addEventListener('click', () => {
        navMenu.classList.toggle('active');
    });

    document.addEventListener('DOMContentLoaded', () => {
        fetchJewelryData();
    });

    async function orderNow(productId) {
    const user = JSON.parse(localStorage.getItem('user'));

    if (!user || !user.id) {
        alert('Please log in to place an order.');
        return;
    }

    const product = jewelryDatabase.find(p => p.id === productId);

    try {
        const res = await fetch('http://localhost:3000/api/order', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                userId: user.id,
                productId: productId,
                quantity: 1
            })
        });

        const data = await res.json();

        if (data.success) {
            alert(`Your order for "${product.name}" has been placed successfully!\n\nPrice: $${product.price.toLocaleString()}\n\nWe will call you soon to confirm the order.`);
        } else {
            alert('Failed to place order: ' + data.message);
        }
    } catch (err) {
        console.error(err);
        alert('Error placing order. Please try again.');
    }
}

    </script>
</body>
</html>