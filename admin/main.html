<!DOCTYPE html>
<html>
<head>
    <title>Admin Panel - Roda Gems</title>
    <style>
        body
         { font-family: Arial; 
            margin: 20px;
         }
        nav 
        { 
            margin-bottom: 20px; 
        }
        button
         { margin: 5px; padding: 5px 10px; }
        table 
        { border-collapse: collapse; 
            width: 100%; 
            margin-bottom: 20px; }
        th, td 
        { border: 1px solid #ccc; 
            padding: 8px; 
            text-align: left; }
        th 
        { background-color: #f4f4f4; }
        input 
        { padding: 5px; 
            width: 100%; }
    </style>
</head>
<body>
    <h1>Roda Gems Admin Panel</h1>
    <nav>
        <button onclick="loadUsers()">Users</button>
        <button onclick="loadProducts()">Products</button>
        <button onclick="loadOrders()">Orders</button>
    </nav>

    <div id="content"></div>

    <script>
        const apiBase = 'http://localhost:3000/api';

        async function loadUsers() {
            const res = await fetch(`${apiBase}/users`);
            const users = await res.json();
            let html = `<h2>Users</h2><table><tr><th>ID</th><th>Username</th><th>Email</th><th>Action</th></tr>`;
            users.forEach(u => {
                html += `<tr>
                    <td>${u.id}</td>
                    <td>${u.username}</td>
                    <td>${u.email}</td>
                    <td><button onclick="deleteUser(${u.id})">Delete</button></td>
                </tr>`;
            });
            html += `</table>`;
            document.getElementById('content').innerHTML = html;
        }

        async function deleteUser(id) {
            if (confirm('Delete this user?')) {
                await fetch(`${apiBase}/users/${id}`, { method: 'DELETE' });
                loadUsers();
            }
        }

        async function loadProducts() {
            const res = await fetch(`${apiBase}/jewelry`);
            const products = await res.json();
            let html = `<h2>Products</h2><table><tr>
                <th>ID</th><th>Name</th><th>Category</th><th>Price</th><th>Update</th></tr>`;
            products.forEach(p => {
                html += `<tr>
                    <td>${p.id}</td>
                    <td><input value="${p.name}" id="name${p.id}"></td>
                    <td><input value="${p.category}" id="cat${p.id}"></td>
                    <td><input value="${p.price}" id="price${p.id}"></td>
                    <td><button onclick="updateProduct(${p.id})">Save</button></td>
                </tr>`;
            });
            html += `</table>`;
            document.getElementById('content').innerHTML = html;
        }

        async function updateProduct(id) {
            const name = document.getElementById(`name${id}`).value;
            const category = document.getElementById(`cat${id}`).value;
            const price = document.getElementById(`price${id}`).value;
            await fetch(`${apiBase}/jewelry/${id}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name, category, material: '', description: '', price, image: '', badge: '' })
            });
            alert('Product updated');
            loadProducts();
        }

        async function loadOrders() {
            const res = await fetch(`${apiBase}/orders`);
            const orders = await res.json();
            let html = `<h2>Orders</h2><table><tr><th>ID</th><th>User</th><th>Product</th><th>Qty</th><th>Date</th></tr>`;
            orders.forEach(o => {
                html += `<tr>
                    <td>${o.id}</td>
                    <td>${o.username}</td>
                    <td>${o.product}</td>
                    <td>${o.quantity}</td>
                    <td>${o.order_date}</td>
                </tr>`;
            });
            html += `</table>`;
            document.getElementById('content').innerHTML = html;
        }

        async function loadProducts() {
    const res = await fetch(`${apiBase}/jewelry`);
    const products = await res.json();
    let html = `<h2>Products</h2><table><tr>
        <th>ID</th><th>Name</th><th>Category</th><th>Price</th><th>Update</th><th>Delete</th></tr>`;
    products.forEach(p => {
        html += `<tr>
            <td>${p.id}</td>
            <td><input value="${p.name}" id="name${p.id}"></td>
            <td><input value="${p.category}" id="cat${p.id}"></td>
            <td><input value="${p.price}" id="price${p.id}"></td>
            <td><button onclick="updateProduct(${p.id})">Save</button></td>
            <td><button onclick="deleteProduct(${p.id})" style="background:red;color:white;">Delete</button></td>
        </tr>`;
    });
    html += `</table>`;
    document.getElementById('content').innerHTML = html;
}

async function deleteProduct(id) {
    if (confirm('Are you sure you want to delete this product?')) {
        await fetch(`${apiBase}/jewelry/${id}`, { method: 'DELETE' });
        loadProducts();
    }
}

    </script>
</body>
</html>
